<!doctype html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>测试系统登录</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- <script src="https://unpkg.com/vue-router@2.0.0/dist/vue-router.js"></script> -->
    <script src="https://unpkg.com/axios/dist/axios.js"></script>

</head>

<body>
    <h1>OOAD - 提交测试</h1>

    <div id="loginbox">
        用户名<br>
        <input v-model="account" placeholder="登录账号"><br>
        <br>
        密码<br>
        <input v-model="password" placeholder="登录密码"><br>
        <br>
        <button v-on:click="login()">登录</button>
        <button v-on:click="logout()">退出登录</button><br>
        <br>
        <div v-if="notice != '' && notice != undefined"><b>通知</b> {{notice}}</div>
    </div>
    <script>
        var noticeChecking;
        new Vue({
            el: '#loginbox',
            data: {
                account: "G003",
                password: "333",
                notice: "",
            },
            mounted() {
                /* Do Nothing */
            },
            methods: {
                login: function () {
                    var model = {
                        account: this.account,
                        password: this.password,
                    }
                    axios
                        .post('/ajax/login', model)
                        .then(response => {
                            console.log('/ajax/login', response.data)
                            if (response.data.error == undefined) {
                                this.notice = response.data.info
                                window.location.href = "/pannel"
                            } else {
                                this.notice = response.data.error
                            }
                        })
                        .catch(error => {
                            this.notice = "芜湖，前端写错了或者服务器挂了."
                            console.log('/ajax/login', error.response.data)
                        })
                },
                logout: function () {
                    axios
                        .post('/ajax/logout')
                        .then(response => {
                            console.log(response.data)
                        })
                        .catch(error => {
                            console.log(error.response.data)
                        })
                        .finally(() => this.loading = false)
                },
            },
        })
    </script>

</body>

</html>